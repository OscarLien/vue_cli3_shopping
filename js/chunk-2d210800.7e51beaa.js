(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d210800"],{b7c8:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var a=e.handleSubmit;return[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),s("div",[0==t.cart.total?s("div",{staticClass:"d-flex justify-content-center align-items-center text-center",staticStyle:{height:"350px"}},[s("div",[s("h3",[t._v("您的購物車內還沒有任何商品")]),s("router-link",{attrs:{to:"/product"}},[s("button",{staticClass:"btn btn-outline-primary my-3"},[s("i",{staticClass:"fas fa-shopping-cart pr-2"}),t._v("馬上去選購 ")])])],1)]):t._e(),0!==t.cart.total?s("div",{staticClass:"container pt-5"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-12 col-md-8 px-0"},[s("ul",{staticClass:"list-unstyled d-flex justify-content-around"},[s("li",{staticClass:"checkStep checkStepActive"},[s("span",{staticClass:"text-center"},[t._v(" 1. 填寫訂購資料")])]),s("li",{staticClass:"checkStep"},[s("span",{staticClass:"text-center"},[t._v("2. 確認付款")])]),s("li",{staticClass:"checkStep"},[s("span",{staticClass:"text-center"},[t._v("3. 完成")])])])])])]):t._e(),0!==t.cart.total?s("div",{staticClass:"container"},[s("div",{staticClass:"my-5 row justify-content-center"},[s("div",{staticClass:"col-12 col-md-8"},[s("h2",{staticClass:"text-center mb-3"},[t._v("訂購資訊")]),s("table",{staticClass:"table"},[s("thead",[s("th"),s("th",{staticClass:"text-nowrap",attrs:{scope:"col"}},[t._v("品名")]),s("th",{staticClass:"text-nowrap",attrs:{scope:"col"}},[t._v("數量")]),s("th",{attrs:{scope:"col"}},[t._v("單價")])]),s("tbody",t._l(t.cart.carts,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"align-middle"},[s("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(s){return t.delCart(e.id)}}},[s("i",{staticClass:"far fa-trash-alt"})])]),s("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.product.title)+" "),e.coupon?s("div",{staticClass:"text-success"},[t._v(" 已套用優惠券 ")]):t._e()]),s("td",{staticClass:"align-middle text-nowrap"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.qty,expression:"item.qty"}],attrs:{name:"",id:""},on:{change:[function(s){var a=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"qty",s.target.multiple?a:a[0])},function(s){return t.changeQty(e.id,e.product.id,e.qty)}]}},t._l(10,(function(e){return s("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0),t._v(" "+t._s(e.product.unit)+" ")]),s("td",{staticClass:"align-middle text-right"},[t._v(" "+t._s(t._f("currency")(e.final_total))+" ")])])})),0),s("tfoot",[s("tr",[s("td",{staticClass:"text-right",attrs:{colspan:"3"}},[t._v("總計")]),s("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.cart.total)))])]),t.cart.final_total!=t.cart.total?s("tr",[s("td",{staticClass:"text-right text-success",attrs:{colspan:"3"}},[t._v("折扣價")]),s("td",{staticClass:"text-right text-success"},[t._v(" "+t._s(t._f("currency")(t.cart.final_total))+" ")])]):t._e()])]),s("div",{staticClass:"input-group mb-3 input-group-sm"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{input:function(e){e.target.composing||(t.coupon_code=e.target.value)}}}),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:t.applyCoupon}},[t._v(" 套用優惠碼 ")])])])]),s("div",{staticClass:"col-12 col-md-8 mb-5"},[s("h2",{staticClass:"text-center"},[t._v("填寫訂購資料")]),s("div",{staticClass:"form-row"},[s("form",{staticClass:"col-12",on:{submit:function(e){return e.preventDefault(),a(t.createOrder)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("電子郵件"),s("span",{staticClass:"text-danger"},[t._v("*必填")])]),s("ValidationProvider",{attrs:{name:"email",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors,r=e.classes;return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",class:r,attrs:{type:"email",id:"email",name:"email",placeholder:"請輸入Email"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),s("span",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}],null,!0)})],1),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v("姓名"),s("span",{staticClass:"text-danger"},[t._v("*必填")])]),s("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors,r=e.classes;return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:r,attrs:{type:"text",id:"name",name:"name",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),s("span",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}],null,!0)})],1),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"tel"}},[t._v("電話"),s("span",{staticClass:"text-danger"},[t._v("*必填")])]),s("ValidationProvider",{attrs:{name:"tel",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors,r=e.classes;return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:r,attrs:{type:"text",id:"tel",name:"tel",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),s("span",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}],null,!0)})],1),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"address"}},[t._v("地址"),s("span",{staticClass:"text-danger"},[t._v("*必填")])]),s("ValidationProvider",{attrs:{name:"address",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors,r=e.classes;return[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",class:r,attrs:{type:"text",id:"address",name:"address",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),s("span",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}],null,!0)})],1),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"message"}},[t._v("留言")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"message",id:"message",rows:"3",placeholder:"有什麼話想告訴我們？"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),s("div",{staticClass:"text-right"},[s("button",{staticClass:"btn btn-outline-primary",attrs:{type:"submit"}},[t._v(" 建立訂單 ")])])])])])])]):t._e()])]}}])})},r=[],o=(s("99af"),s("5530")),c=s("2f62"),n={data:function(){return{coupon_code:"",form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},methods:Object(o["a"])({applyCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("oscar","/coupon"),s={code:t.coupon_code};t.$http.post(e,{data:s}).then((function(e){e.data.success?(t.$store.dispatch("cartModules/updateMessage",{message:e.data.message,status:"success"}),t.getCart()):t.$store.dispatch("cartModules/updateMessage",{message:e.data.message,status:"danger"})}))},createOrder:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("oscar","/order"),s=t.form;t.isLoading=!0,t.$http.post(e,{data:s}).then((function(e){e.data.success&&(t.$store.dispatch("cartModules/updateMessage",{message:e.data.message,status:"success"}),t.$router.push("/payment/".concat(e.data.orderId)),t.$store.dispatch("cartModules/getCart"),t.isLoading=!1)}))},changeQty:function(t,e,s){var a=this,r="".concat("https://vue-course-api.hexschool.io","/api/").concat("oscar","/cart"),o="".concat("https://vue-course-api.hexschool.io","/api/").concat("oscar","/cart/").concat(t),c={product_id:e,qty:s};a.$http.all([a.$http.delete(o),a.$http.post(r,{data:c})]).then(a.$http.spread((function(){a.getCart()})))}},Object(c["b"])("cartModules",["getCart","delCart"])),computed:Object(o["a"])({},Object(c["c"])("cartModules",["cart"])),created:function(){this.getCart()}},i=n,l=s("2877"),u=Object(l["a"])(i,a,r,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d210800.7e51beaa.js.map